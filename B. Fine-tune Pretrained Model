{"metadata":{"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python","version":"3.10.12","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"kaggle":{"accelerator":"none","dataSources":[{"sourceId":11037016,"sourceType":"datasetVersion","datasetId":6874507}],"dockerImageVersionId":30919,"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":false},"colab":{"provenance":[{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/b-pretrained-model-e8d87385-e9cd-44a3-a9ec-bc535a70d9ba.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20250318/auto/storage/goog4_request&X-Goog-Date=20250318T175324Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=76e87f539a1359ce61100dde1684821a44a601d1e6be4337cc6f24c4ed5d2cfeda11162f9a3346ce80da90ed570c573f05c08e39c6f5bd48aeaf83790dac7054e2b1fc7109f9c4b220f2c487aa5cbe07b815478a38d81b38568009bb0b3f540df14544a4ab01a20176bb86918b4ba55f6f0f6634bf1e77104e7318e804643acd0effbd6a6a9b460f3a263affac77a4e0f665abd207a5466eb76703b5dba6a4118e86a67a61be354f6934189be569c267bcefdeabc3eca538306aca59b046a1b5f489a18a872c93bdaeadfe9e3cc34e034254fe461a4547566ca3dcd4e72fbaa351a0c1d88ad24589c105c05f03a5b4ccdd997b739ebc10d86eba5dde9d83dab0","timestamp":1742320410407}],"gpuType":"T4"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"460277e8751445a48b73dc3860cde1ab":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ff91a48d2931426bbdf8d263dab9a790","IPY_MODEL_d7583b022c1243f8afe2124f74834fc4","IPY_MODEL_d445135b4c09418fa4d267b7be465ae4"],"layout":"IPY_MODEL_0cf3484dd0de42848ce4849f80bcb06c"}},"ff91a48d2931426bbdf8d263dab9a790":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0adaefcca42a47d282c48306362c661a","placeholder":"​","style":"IPY_MODEL_0e6f88860aec44d5a843cd5e659f586e","value":"Map: 100%"}},"d7583b022c1243f8afe2124f74834fc4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2e2b35f3966f43aeb63e4d91c3636d75","max":900,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a965c37096d14d9b90d534c7513849fd","value":900}},"d445135b4c09418fa4d267b7be465ae4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_70a280b6393d430c92ce1c2eec617b89","placeholder":"​","style":"IPY_MODEL_32da7b2c483f4f6ba238cd6cf8011fc6","value":" 900/900 [00:01&lt;00:00, 726.95 examples/s]"}},"0cf3484dd0de42848ce4849f80bcb06c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0adaefcca42a47d282c48306362c661a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0e6f88860aec44d5a843cd5e659f586e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2e2b35f3966f43aeb63e4d91c3636d75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a965c37096d14d9b90d534c7513849fd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"70a280b6393d430c92ce1c2eec617b89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32da7b2c483f4f6ba238cd6cf8011fc6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b63e547497f946e4ba8b8bc1c4134040":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_502c6490630b43ddbf781cab4f4d3788","IPY_MODEL_b388912473dd4a898fae8408c1cc34c8","IPY_MODEL_76bfa7f56b874676aac95fb7a23ac7e5"],"layout":"IPY_MODEL_73450280312844f2870d65fc92f654a8"}},"502c6490630b43ddbf781cab4f4d3788":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5937f36225f948b49a55523db761fb05","placeholder":"​","style":"IPY_MODEL_410f9b766d3245d3ae8c3faee03d6431","value":"Map: 100%"}},"b388912473dd4a898fae8408c1cc34c8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_34ca514cca9b44dfb44d6bfaca6e9739","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e7351bc6755a4d3f80684966ace8ec42","value":100}},"76bfa7f56b874676aac95fb7a23ac7e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4894e6d5832b4eaba83e9f2db94aa2f2","placeholder":"​","style":"IPY_MODEL_568bf93863674c1c813719d999e2154f","value":" 100/100 [00:00&lt;00:00, 589.77 examples/s]"}},"73450280312844f2870d65fc92f654a8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5937f36225f948b49a55523db761fb05":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"410f9b766d3245d3ae8c3faee03d6431":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34ca514cca9b44dfb44d6bfaca6e9739":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e7351bc6755a4d3f80684966ace8ec42":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4894e6d5832b4eaba83e9f2db94aa2f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"568bf93863674c1c813719d999e2154f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat_minor":0,"nbformat":4,"cells":[{"cell_type":"code","source":["pip install datasets"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gxQn4rJEZzit","executionInfo":{"status":"ok","timestamp":1742424303716,"user_tz":240,"elapsed":16507,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"cd78af94-b6a5-4d2e-922a-116db4a37855"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting datasets\n","  Downloading datasets-3.4.1-py3-none-any.whl.metadata (19 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from datasets) (3.17.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.0.2)\n","Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (18.1.0)\n","Collecting dill<0.3.9,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.8-py3-none-any.whl.metadata (10 kB)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets) (2.2.2)\n","Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.32.3)\n","Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.11/dist-packages (from datasets) (4.67.1)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.5.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n","Collecting multiprocess<0.70.17 (from datasets)\n","  Downloading multiprocess-0.70.16-py311-none-any.whl.metadata (7.2 kB)\n","Requirement already satisfied: fsspec<=2024.12.0,>=2023.1.0 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]<=2024.12.0,>=2023.1.0->datasets) (2024.10.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets) (3.11.13)\n","Requirement already satisfied: huggingface-hub>=0.24.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.28.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from datasets) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (6.0.2)\n","Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (2.6.1)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.3.2)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (25.3.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.5.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (6.1.0)\n","Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (0.3.0)\n","Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.18.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub>=0.24.0->datasets) (4.12.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.4.1)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2.3.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2025.1.31)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.1)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n","Downloading datasets-3.4.1-py3-none-any.whl (487 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m487.4/487.4 kB\u001b[0m \u001b[31m6.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading dill-0.3.8-py3-none-any.whl (116 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m6.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading multiprocess-0.70.16-py311-none-any.whl (143 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m143.5/143.5 kB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading xxhash-3.5.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.8/194.8 kB\u001b[0m \u001b[31m12.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: xxhash, dill, multiprocess, datasets\n","Successfully installed datasets-3.4.1 dill-0.3.8 multiprocess-0.70.16 xxhash-3.5.0\n"]}]},{"cell_type":"code","source":["import datasets\n","from transformers import MarianTokenizer, MarianMTModel, Seq2SeqTrainingArguments, Seq2SeqTrainer, EarlyStoppingCallback\n","import torch\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T15:33:00.744993Z","iopub.execute_input":"2025-03-18T15:33:00.745497Z","iopub.status.idle":"2025-03-18T15:33:33.77904Z","shell.execute_reply.started":"2025-03-18T15:33:00.745463Z","shell.execute_reply":"2025-03-18T15:33:33.778024Z"},"id":"NH8THb53Y406","executionInfo":{"status":"ok","timestamp":1742424364765,"user_tz":240,"elapsed":61046,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"outputs":[],"execution_count":2},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')\n","\n","tcn = pd.read_csv('/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/datasets/dev_tcn.csv')\n","en  = pd.read_csv('/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/datasets/dev_en.csv')\n","\n","dev =  pd.concat([en['translation_output'], tcn['text']], axis=1)\n","dev.columns = ['en', 'zh']"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T15:33:33.780517Z","iopub.execute_input":"2025-03-18T15:33:33.781329Z","iopub.status.idle":"2025-03-18T15:33:35.597629Z","shell.execute_reply.started":"2025-03-18T15:33:33.781295Z","shell.execute_reply":"2025-03-18T15:33:35.596483Z"},"id":"29ywRqzAY407","outputId":"3d9b52c1-b024-4c91-d606-3f42d0b03a86","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1742424775736,"user_tz":240,"elapsed":542,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"execution_count":16},{"cell_type":"code","source":["import re\n","\n","def cleaning_string(my_string):\n","    my_string = re.sub(r\"[^a-z0-9 ]+\", ' ', my_string.lower()) # lowercase then change special char to ''\n","    my_string = \" \".join(my_string.split()) # remove white space\n","\n","    return my_string\n","\n","dev['en'] = dev['en'].map(cleaning_string)"],"metadata":{"id":"TcGmMgFVmBmz","executionInfo":{"status":"ok","timestamp":1742424775889,"user_tz":240,"elapsed":55,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["pip install opencc"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JtE1HZCCmxaD","executionInfo":{"status":"ok","timestamp":1742424719451,"user_tz":240,"elapsed":6372,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"d35ddca6-6aac-4acc-d7ab-e3ff82ff48d1"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting opencc\n","  Downloading OpenCC-1.1.9-cp311-cp311-manylinux2014_x86_64.whl.metadata (13 kB)\n","Downloading OpenCC-1.1.9-cp311-cp311-manylinux2014_x86_64.whl (1.7 MB)\n","\u001b[?25l   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/1.7 MB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K   \u001b[91m━━━\u001b[0m\u001b[90m╺\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.1/1.7 MB\u001b[0m \u001b[31m4.0 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K   \u001b[91m━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.9/1.7 MB\u001b[0m \u001b[31m13.1 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K   \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m1.6/1.7 MB\u001b[0m \u001b[31m19.3 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m14.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: opencc\n","Successfully installed opencc-1.1.9\n"]}]},{"cell_type":"code","source":["import opencc\n","\n","# Initialize the converter\n","converter = opencc.OpenCC('s2t')  # 's2t' means Simplified to Traditional\n","\n","def convert_to_traditional(text):\n","    try:\n","      x = converter.convert(text)\n","    except:\n","      x = text\n","    return x\n","\n","# remove punctuation, non chinese words, special characters\n","def non_chinese_removal(line):\n","    p1 = re.compile(r'''~!@#$%^&*()_\\-+=<>?:\"{}|,.\\/;'\\[]·~！@#￥%……&*（）——\\-+={}|「『《》？：“”【】、；‘'，。、''')\n","    p2 = re.compile(r'[^\\u4e00-\\u9fa5a-zA-Z0-9]') #keep numbers and English letters\n","\n","    line = p1.sub(r' ',str(line))\n","    line = p2.sub(r' ',str(line))\n","\n","    return line\n","\n","dev['zh']  = dev['zh'].map(convert_to_traditional).map(non_chinese_removal)"],"metadata":{"id":"NFJgkuPXmYIf","executionInfo":{"status":"ok","timestamp":1742424967782,"user_tz":240,"elapsed":161,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","source":["dev"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"qWCpTgnDm55H","executionInfo":{"status":"ok","timestamp":1742424968954,"user_tz":240,"elapsed":20,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"1965160a-c240-424b-da08-3d020f34b677"},"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    en  \\\n","0    oppo a75 a75s a73 phone case soft rabbit silic...   \n","1            soft 99 coating car wax strong water watt   \n","2                low sugar mango dry 250g be the royal   \n","3    the culture japan imported round top space cra...   \n","4    hello kitty sandals shoes white red children n...   \n","..                                                 ...   \n","995  hippored torn fun unique style straight jeans ...   \n","996  kids set table bay thin long sleeve home suit ...   \n","997  longchamp le pliage neo high density nylon bac...   \n","998  ifairies opening adjustable ring ifairies 5647...   \n","999  polarstar women sweat quick dry t shirt black ...   \n","\n","                                                    zh  \n","0                  OPPO A75 A75s A73 手機殼 軟殼 掛繩殼 大眼兔硅膠殼  \n","1                                  SOFT 99 鍍膜車蠟 強力撥水型   \n","2                                       低糖芒果乾 250g 臻御行  \n","3     小徑文化 日本進口ROUND TOP space craft   diamond  SC ...  \n","4            Hello Kitty 凱蒂貓 KITTY 涼鞋 童鞋 白 紅色 小童 no739  \n","..                                                 ...  \n","995                 HippoRed 撕破樂趣 獨特風格 中直筒牛仔褲 O591 445  \n","996                      兒童套裝 臺灣製薄長袖居家套裝 魔法Baby k60092  \n","997                 LONGCHAMP Le Pliage Neo高密尼龍後揹包 中型   \n","998            iFairies 開口可調節戒指 ifairies 56472  56472   \n","999                        PolarStar 女 排汗快乾T恤 黑 P18102  \n","\n","[1000 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-61ae6285-74f7-407a-b297-edc30bfc0505\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>en</th>\n","      <th>zh</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>oppo a75 a75s a73 phone case soft rabbit silic...</td>\n","      <td>OPPO A75 A75s A73 手機殼 軟殼 掛繩殼 大眼兔硅膠殼</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>soft 99 coating car wax strong water watt</td>\n","      <td>SOFT 99 鍍膜車蠟 強力撥水型</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>low sugar mango dry 250g be the royal</td>\n","      <td>低糖芒果乾 250g 臻御行</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>the culture japan imported round top space cra...</td>\n","      <td>小徑文化 日本進口ROUND TOP space craft   diamond  SC ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>hello kitty sandals shoes white red children n...</td>\n","      <td>Hello Kitty 凱蒂貓 KITTY 涼鞋 童鞋 白 紅色 小童 no739</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>995</th>\n","      <td>hippored torn fun unique style straight jeans ...</td>\n","      <td>HippoRed 撕破樂趣 獨特風格 中直筒牛仔褲 O591 445</td>\n","    </tr>\n","    <tr>\n","      <th>996</th>\n","      <td>kids set table bay thin long sleeve home suit ...</td>\n","      <td>兒童套裝 臺灣製薄長袖居家套裝 魔法Baby k60092</td>\n","    </tr>\n","    <tr>\n","      <th>997</th>\n","      <td>longchamp le pliage neo high density nylon bac...</td>\n","      <td>LONGCHAMP Le Pliage Neo高密尼龍後揹包 中型</td>\n","    </tr>\n","    <tr>\n","      <th>998</th>\n","      <td>ifairies opening adjustable ring ifairies 5647...</td>\n","      <td>iFairies 開口可調節戒指 ifairies 56472  56472</td>\n","    </tr>\n","    <tr>\n","      <th>999</th>\n","      <td>polarstar women sweat quick dry t shirt black ...</td>\n","      <td>PolarStar 女 排汗快乾T恤 黑 P18102</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1000 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-61ae6285-74f7-407a-b297-edc30bfc0505')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-61ae6285-74f7-407a-b297-edc30bfc0505 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-61ae6285-74f7-407a-b297-edc30bfc0505');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0fa2967c-cfb1-4dc2-9d76-34eca4dd49d7\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0fa2967c-cfb1-4dc2-9d76-34eca4dd49d7')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0fa2967c-cfb1-4dc2-9d76-34eca4dd49d7 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_d673bb66-1b9f-4fab-af76-60e407256b0c\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('dev')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_d673bb66-1b9f-4fab-af76-60e407256b0c button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('dev');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"dev","summary":"{\n  \"name\": \"dev\",\n  \"rows\": 1000,\n  \"fields\": [\n    {\n      \"column\": \"en\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1000,\n        \"samples\": [\n          \"hawk h31 multifunctional car magnetic holder\",\n          \"outerspace official donkey jesus polo shirt\",\n          \"morinoxlucas designer joint classic plain sports vest value 3 pcs mo5110\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"zh\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1000,\n        \"samples\": [\n          \"Hawk H31 \\u591a\\u529f\\u80fd\\u6c7d\\u8eca\\u5f8c\\u5ea7\\u78c1\\u5438\\u652f\\u67b6\",\n          \"OUTERSPACE\\u5b98\\u65b9  \\u9a0e\\u9a62\\u7684\\u8036\\u7a4cPOLO\\u886b\",\n          \"MORINOxLUCAS\\u8a2d\\u8a08\\u5e2b\\u806f\\u540d \\u7d93\\u5178\\u7d20\\u8272\\u904b\\u52d5\\u80cc\\u5fc3 \\u8d85\\u503c3\\u5165\\u7d44  MO5110\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":24}]},{"cell_type":"code","source":["dataset = datasets.Dataset.from_pandas(dev.dropna()).train_test_split(test_size=0.1)"],"metadata":{"id":"Y-9SwzhSaeSC","executionInfo":{"status":"ok","timestamp":1742424982839,"user_tz":240,"elapsed":64,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["# Load the pre-trained model and tokenizer\n","model_name = 'agentlans/zhtw-en'\n","tokenizer = MarianTokenizer.from_pretrained(model_name)\n","model = MarianMTModel.from_pretrained(model_name)\n","\n","# Enable mixed precision and move to GPU\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","model = model.to(device)"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T15:33:35.599835Z","iopub.execute_input":"2025-03-18T15:33:35.600232Z","iopub.status.idle":"2025-03-18T15:33:40.441917Z","shell.execute_reply.started":"2025-03-18T15:33:35.6002Z","shell.execute_reply":"2025-03-18T15:33:40.440699Z"},"id":"EZEIzvvKY408","executionInfo":{"status":"ok","timestamp":1742424988987,"user_tz":240,"elapsed":4644,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"6c8a9f8c-f279-4d32-f4af-2d26bf9b3155"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/transformers/models/marian/tokenization_marian.py:175: UserWarning: Recommended: pip install sacremoses.\n","  warnings.warn(\"Recommended: pip install sacremoses.\")\n"]}],"execution_count":26},{"cell_type":"code","source":["def tokenize_function(examples):\n","    # Tokenize the source (Chinese) and target (English) text\n","    source = tokenizer(examples[\"zh\"], truncation=True, padding=\"max_length\", max_length=64)\n","    target = tokenizer(examples[\"en\"], truncation=True, padding=\"max_length\", max_length=64)\n","\n","    # Return the tokenized inputs and labels\n","    return {\n","        \"input_ids\": source[\"input_ids\"],\n","        \"attention_mask\": source[\"attention_mask\"],\n","        \"labels\": target[\"input_ids\"],\n","    }\n","\n","# Apply tokenization to the dataset\n","tokenized_dataset = dataset.map(tokenize_function, batched=True)\n","print(tokenized_dataset)"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T15:33:40.443197Z","iopub.execute_input":"2025-03-18T15:33:40.443484Z","iopub.status.idle":"2025-03-18T15:34:40.773323Z","shell.execute_reply.started":"2025-03-18T15:33:40.443459Z","shell.execute_reply":"2025-03-18T15:34:40.772318Z"},"id":"iDtVYeb_Y408","outputId":"8fe0fd94-af81-4ca2-e0be-d8f7567c3b12","colab":{"referenced_widgets":["460277e8751445a48b73dc3860cde1ab","ff91a48d2931426bbdf8d263dab9a790","d7583b022c1243f8afe2124f74834fc4","d445135b4c09418fa4d267b7be465ae4","0cf3484dd0de42848ce4849f80bcb06c","0adaefcca42a47d282c48306362c661a","0e6f88860aec44d5a843cd5e659f586e","2e2b35f3966f43aeb63e4d91c3636d75","a965c37096d14d9b90d534c7513849fd","70a280b6393d430c92ce1c2eec617b89","32da7b2c483f4f6ba238cd6cf8011fc6","b63e547497f946e4ba8b8bc1c4134040","502c6490630b43ddbf781cab4f4d3788","b388912473dd4a898fae8408c1cc34c8","76bfa7f56b874676aac95fb7a23ac7e5","73450280312844f2870d65fc92f654a8","5937f36225f948b49a55523db761fb05","410f9b766d3245d3ae8c3faee03d6431","34ca514cca9b44dfb44d6bfaca6e9739","e7351bc6755a4d3f80684966ace8ec42","4894e6d5832b4eaba83e9f2db94aa2f2","568bf93863674c1c813719d999e2154f"],"base_uri":"https://localhost:8080/","height":260},"executionInfo":{"status":"ok","timestamp":1742424994942,"user_tz":240,"elapsed":5952,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/900 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"460277e8751445a48b73dc3860cde1ab"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/100 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b63e547497f946e4ba8b8bc1c4134040"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['en', 'zh', 'input_ids', 'attention_mask', 'labels'],\n","        num_rows: 900\n","    })\n","    test: Dataset({\n","        features: ['en', 'zh', 'input_ids', 'attention_mask', 'labels'],\n","        num_rows: 100\n","    })\n","})\n"]}],"execution_count":27},{"cell_type":"code","source":["training_args = Seq2SeqTrainingArguments(\n","    output_dir=\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN\",      # Directory to save the model and training outputs\n","    evaluation_strategy=\"steps\",              # Evaluate every `eval_steps` steps\n","    eval_steps=500,                          # Evaluate every 500 steps\n","    save_strategy=\"steps\",                   # Save checkpoint every `save_steps` steps\n","    save_steps=500,                          # Save checkpoint every 500 steps\n","    learning_rate=2e-5,                      # Learning rate\n","    per_device_train_batch_size=8,           # Batch size for training\n","    per_device_eval_batch_size=8,            # Batch size for evaluation\n","    num_train_epochs=5,                     # Number of training epochs\n","    weight_decay=0.01,                       # Weight decay for regularization\n","    save_total_limit=2,                      # Limit the number of saved checkpoints\n","    logging_dir=\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/logs\",                    # Directory for logs\n","    logging_steps=10,                        # Log every 10 steps\n","    fp16=True,                               # Use mixed precision (if supported)\n","    gradient_accumulation_steps=4,           # Accumulate gradients over 4 steps\n","    predict_with_generate=True,              # Generate predictions during evaluation\n","    push_to_hub=False,                       # Set to True if you want to upload to Hugging Face Hub\n","    report_to=\"none\",\n","    load_best_model_at_end=True,             # Load the best model at the end of training\n","    metric_for_best_model=\"eval_loss\",       # Metric to determine the best model\n","    greater_is_better=False                  # Whether the metric should be maximized or minimized\n",")\n","\n","# Freeze all layers first\n","for param in model.parameters():\n","    param.requires_grad = False\n","\n","# Unfreeze the last N layers (e.g., last 2 layers)\n","num_unfrozen_layers = 1\n","for layer in model.base_model.encoder.layers[-num_unfrozen_layers:]:\n","    for param in layer.parameters():\n","        param.requires_grad = True\n","\n","# Optionally, unfreeze the embedding layer if needed\n","for param in model.base_model.encoder.embed_tokens.parameters():\n","    param.requires_grad = False\n","\n","# Initialize the Trainer\n","trainer = Seq2SeqTrainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=tokenized_dataset[\"train\"],\n","    eval_dataset=tokenized_dataset[\"test\"],\n","    tokenizer=tokenizer,\n","    callbacks=[EarlyStoppingCallback(early_stopping_patience=3)]\n",")\n","\n","total_params = model.num_parameters()\n","trainable_params = sum(p.numel() for p in model.parameters() if p.requires_grad)\n","\n","print(f\"Total Parameters: {total_params:,}\")\n","print(f\"Trainable Parameters: {trainable_params:,}\")\n","\n","# Fine-tune the model\n","trainer.train()"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T15:39:06.626857Z","iopub.execute_input":"2025-03-18T15:39:06.627231Z","iopub.status.idle":"2025-03-18T15:39:06.649559Z","shell.execute_reply.started":"2025-03-18T15:39:06.6272Z","shell.execute_reply":"2025-03-18T15:39:06.648235Z"},"id":"E4Gn3LKYY409","outputId":"25d0d22b-44e4-4abf-9ff8-4d88a088ce8f","colab":{"base_uri":"https://localhost:8080/","height":297},"executionInfo":{"status":"ok","timestamp":1742427035908,"user_tz":240,"elapsed":1974684,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.11/dist-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead\n","  warnings.warn(\n","<ipython-input-28-dfbdfa28da71>:40: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.\n","  trainer = Seq2SeqTrainer(\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["Total Parameters: 77,943,296\n","Trainable Parameters: 3,152,384\n"]},{"data":{"text/html":["\n","    <div>\n","      \n","      <progress value='3' max='140' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [  3/140 00:20 < 45:54, 0.05 it/s, Epoch 0.07/5]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='140' max='140' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [140/140 33:18, Epoch 4/5]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=140, training_loss=7.246944645472936, metrics={'train_runtime': 2018.0975, 'train_samples_per_second': 2.23, 'train_steps_per_second': 0.069, 'total_flos': 74034029002752.0, 'train_loss': 7.246944645472936, 'epoch': 4.849557522123893})"]},"metadata":{},"execution_count":28}],"execution_count":28},{"cell_type":"code","source":["# Step 9: Evaluate the Model\n","# Evaluate the model on the validation set\n","eval_results = trainer.evaluate()\n","print(f\"Evaluation results: {eval_results}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":75},"id":"LC-equnMwiwC","executionInfo":{"status":"ok","timestamp":1742427306737,"user_tz":240,"elapsed":34019,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"868bea8d-a642-492e-8e1f-fea123cc9800"},"execution_count":33,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='26' max='13' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [13/13 01:39]\n","    </div>\n","    "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Evaluation results: {'eval_loss': 5.116040229797363, 'eval_runtime': 33.9412, 'eval_samples_per_second': 2.946, 'eval_steps_per_second': 0.383, 'epoch': 4.849557522123893}\n"]}]},{"cell_type":"code","source":["trainer.save_model(\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en\")\n","tokenizer.save_pretrained(\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en\")"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T01:31:30.955294Z","iopub.status.idle":"2025-03-18T01:31:30.955545Z","shell.execute_reply":"2025-03-18T01:31:30.955446Z"},"id":"sdeKEwJ6Y40_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1742427040667,"user_tz":240,"elapsed":4474,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"2166fbee-3f25-4567-96c5-addb86cfc577"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["('/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/tokenizer_config.json',\n"," '/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/special_tokens_map.json',\n"," '/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/vocab.json',\n"," '/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/source.spm',\n"," '/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/target.spm',\n"," '/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en/added_tokens.json')"]},"metadata":{},"execution_count":29}],"execution_count":29},{"cell_type":"code","source":["# Load the fine-tuned model and tokenizer\n","fine_tuned_model = MarianMTModel.from_pretrained(\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en\")\n","fine_tuned_tokenizer = MarianTokenizer.from_pretrained(\"/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/fine-tuned-agentlans-zhtw-en\")\n","\n","# Function to translate Chinese to English\n","def translate_chinese_to_english(text):\n","    inputs = fine_tuned_tokenizer(text, return_tensors=\"pt\", truncation=True, padding=True)\n","    translated_tokens = fine_tuned_model.generate(**inputs)\n","    translated_text = fine_tuned_tokenizer.decode(translated_tokens[0], skip_special_tokens=True)\n","    return translated_text\n","\n","# Test the fine-tuned model\n","test_text = \"高質量手機殼\"\n","translated_text = translate_chinese_to_english(test_text)\n","print(f\"Original: {test_text} -> Translated: {translated_text}\")"],"metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-03-18T01:31:30.956421Z","iopub.status.idle":"2025-03-18T01:31:30.956814Z","shell.execute_reply":"2025-03-18T01:31:30.956631Z"},"id":"DcCjoX-qY41A","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1742427413893,"user_tz":240,"elapsed":4476,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"0a842c5b-b555-4e7e-bae8-e5ceece28c13"},"outputs":[{"output_type":"stream","name":"stdout","text":["Original: 高質量手機殼 -> Translated: High-quality cell phone casings\n"]}],"execution_count":34},{"cell_type":"code","source":["df = pd.read_csv('/content/drive/My Drive/Shopee-Product-Title-Translation_ZH-EN/preprocessed/train_matched_combined.csv')\n","df = df.sample(n=100, random_state=42).reset_index(drop=True)"],"metadata":{"id":"5XaIZlLaxnhd","executionInfo":{"status":"ok","timestamp":1742427797790,"user_tz":240,"elapsed":2778,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":47,"outputs":[]},{"cell_type":"code","source":["from tqdm import tqdm"],"metadata":{"id":"dK5XvlrQxpID","executionInfo":{"status":"ok","timestamp":1742427827467,"user_tz":240,"elapsed":22,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":49,"outputs":[]},{"cell_type":"code","source":["df['text_translated'] = [translate_chinese_to_english(text) for text in tqdm(df['Original'])] # alternative approach"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"id":"tE-UawWvxvH8","executionInfo":{"status":"ok","timestamp":1742429074164,"user_tz":240,"elapsed":1243020,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"5c2a23b6-978c-4877-b977-feece2a7ddc7"},"execution_count":50,"outputs":[{"output_type":"stream","name":"stderr","text":["\n","\n","\n","  0%|          | 0/100 [00:00<?, ?it/s]\u001b[A\u001b[A\u001b[A\n","\n","\n","  1%|          | 1/100 [00:11<18:20, 11.12s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  2%|▏         | 2/100 [00:17<13:16,  8.13s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  3%|▎         | 3/100 [00:19<08:30,  5.27s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  4%|▍         | 4/100 [00:30<12:03,  7.54s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  5%|▌         | 5/100 [00:48<18:13, 11.51s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  6%|▌         | 6/100 [01:12<24:45, 15.80s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  7%|▋         | 7/100 [01:13<16:48, 10.85s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  8%|▊         | 8/100 [01:57<32:56, 21.48s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","  9%|▉         | 9/100 [02:04<25:31, 16.83s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 10%|█         | 10/100 [02:04<17:46, 11.85s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 11%|█         | 11/100 [02:06<12:57,  8.74s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 12%|█▏        | 12/100 [02:22<16:06, 10.98s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 13%|█▎        | 13/100 [02:34<16:11, 11.16s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 14%|█▍        | 14/100 [02:38<12:48,  8.93s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 15%|█▌        | 15/100 [03:18<26:17, 18.56s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 16%|█▌        | 16/100 [03:20<18:53, 13.50s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 17%|█▋        | 17/100 [03:22<13:38,  9.86s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 18%|█▊        | 18/100 [03:23<10:05,  7.39s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 19%|█▉        | 19/100 [04:08<25:07, 18.61s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 20%|██        | 20/100 [04:16<20:33, 15.42s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 21%|██        | 21/100 [04:22<16:46, 12.74s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 22%|██▏       | 22/100 [05:08<29:17, 22.53s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 23%|██▎       | 23/100 [05:52<37:18, 29.07s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 24%|██▍       | 24/100 [05:55<26:59, 21.30s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 25%|██▌       | 25/100 [05:57<19:21, 15.48s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 26%|██▌       | 26/100 [06:04<15:47, 12.80s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 27%|██▋       | 27/100 [06:04<11:09,  9.17s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 28%|██▊       | 28/100 [06:11<09:53,  8.24s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 29%|██▉       | 29/100 [06:20<10:03,  8.50s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 30%|███       | 30/100 [07:05<22:43, 19.48s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 31%|███       | 31/100 [07:50<31:14, 27.17s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 32%|███▏      | 32/100 [07:51<22:03, 19.46s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 33%|███▎      | 33/100 [08:37<30:23, 27.21s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 34%|███▍      | 34/100 [08:42<22:51, 20.77s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 35%|███▌      | 35/100 [08:45<16:42, 15.43s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 36%|███▌      | 36/100 [08:47<12:11, 11.44s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 37%|███▋      | 37/100 [09:10<15:39, 14.91s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 38%|███▊      | 38/100 [09:23<14:47, 14.31s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 39%|███▉      | 39/100 [09:28<11:34, 11.38s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 40%|████      | 40/100 [09:43<12:36, 12.61s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 41%|████      | 41/100 [09:49<10:20, 10.51s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 42%|████▏     | 42/100 [09:54<08:32,  8.84s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 43%|████▎     | 43/100 [10:01<07:55,  8.34s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 44%|████▍     | 44/100 [10:07<07:13,  7.74s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 45%|████▌     | 45/100 [10:10<05:40,  6.18s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 46%|████▌     | 46/100 [10:11<04:10,  4.64s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 47%|████▋     | 47/100 [10:55<14:32, 16.46s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 48%|████▊     | 48/100 [11:41<21:53, 25.27s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 49%|████▉     | 49/100 [11:44<15:54, 18.72s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 50%|█████     | 50/100 [11:48<11:48, 14.17s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 51%|█████     | 51/100 [11:53<09:25, 11.53s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 52%|█████▏    | 52/100 [11:55<06:58,  8.71s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 53%|█████▎    | 53/100 [12:01<06:04,  7.75s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 54%|█████▍    | 54/100 [12:04<04:57,  6.46s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 55%|█████▌    | 55/100 [12:49<13:23, 17.85s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 56%|█████▌    | 56/100 [12:55<10:30, 14.33s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 57%|█████▋    | 57/100 [13:05<09:19, 13.01s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 58%|█████▊    | 58/100 [13:06<06:30,  9.31s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 59%|█████▉    | 59/100 [13:08<04:56,  7.22s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 60%|██████    | 60/100 [13:09<03:32,  5.31s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 61%|██████    | 61/100 [13:09<02:31,  3.89s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 62%|██████▏   | 62/100 [13:10<01:50,  2.91s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 63%|██████▎   | 63/100 [13:11<01:24,  2.28s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 64%|██████▍   | 64/100 [13:14<01:28,  2.46s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 65%|██████▌   | 65/100 [13:18<01:51,  3.19s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 66%|██████▌   | 66/100 [14:04<08:57, 15.82s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 67%|██████▋   | 67/100 [14:20<08:50, 16.07s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 68%|██████▊   | 68/100 [14:22<06:13, 11.67s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 69%|██████▉   | 69/100 [14:24<04:29,  8.70s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 70%|███████   | 70/100 [14:26<03:27,  6.91s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 71%|███████   | 71/100 [14:28<02:34,  5.33s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 72%|███████▏  | 72/100 [15:13<08:02, 17.24s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 73%|███████▎  | 73/100 [15:14<05:36, 12.45s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 74%|███████▍  | 74/100 [15:15<03:55,  9.05s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 75%|███████▌  | 75/100 [15:22<03:26,  8.27s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 76%|███████▌  | 76/100 [15:26<02:46,  6.92s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 77%|███████▋  | 77/100 [15:28<02:06,  5.50s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 78%|███████▊  | 78/100 [15:30<01:39,  4.53s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 79%|███████▉  | 79/100 [16:07<04:59, 14.26s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 80%|████████  | 80/100 [16:10<03:36, 10.83s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 81%|████████  | 81/100 [16:40<05:15, 16.61s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 82%|████████▏ | 82/100 [17:02<05:28, 18.27s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 83%|████████▎ | 83/100 [17:03<03:42, 13.06s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 84%|████████▍ | 84/100 [17:48<06:02, 22.66s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 85%|████████▌ | 85/100 [17:53<04:20, 17.37s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 86%|████████▌ | 86/100 [18:39<06:01, 25.83s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 87%|████████▋ | 87/100 [18:44<04:15, 19.67s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 88%|████████▊ | 88/100 [18:48<03:00, 15.04s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 89%|████████▉ | 89/100 [19:33<04:24, 24.02s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 90%|█████████ | 90/100 [19:37<03:00, 18.07s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 91%|█████████ | 91/100 [19:51<02:30, 16.77s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 92%|█████████▏| 92/100 [19:54<01:40, 12.52s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 93%|█████████▎| 93/100 [19:59<01:11, 10.27s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 94%|█████████▍| 94/100 [20:07<00:57,  9.58s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 95%|█████████▌| 95/100 [20:24<00:59, 12.00s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 96%|█████████▌| 96/100 [20:25<00:34,  8.61s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 97%|█████████▋| 97/100 [20:30<00:22,  7.47s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 98%|█████████▊| 98/100 [20:31<00:11,  5.64s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n"," 99%|█████████▉| 99/100 [20:41<00:06,  6.87s/it]\u001b[A\u001b[A\u001b[A\n","\n","\n","100%|██████████| 100/100 [20:42<00:00, 12.43s/it]\n"]}]},{"cell_type":"code","source":["pip install sacrebleu"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"id":"BUVspmAa3n9V","executionInfo":{"status":"ok","timestamp":1742429142048,"user_tz":240,"elapsed":8794,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"8c4bd75c-f10c-4afb-840a-9a8fb9437f24"},"execution_count":52,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting sacrebleu\n","  Downloading sacrebleu-2.5.1-py3-none-any.whl.metadata (51 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/51.8 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m51.8/51.8 kB\u001b[0m \u001b[31m2.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting portalocker (from sacrebleu)\n","  Downloading portalocker-3.1.1-py3-none-any.whl.metadata (8.6 kB)\n","Requirement already satisfied: regex in /usr/local/lib/python3.11/dist-packages (from sacrebleu) (2024.11.6)\n","Requirement already satisfied: tabulate>=0.8.9 in /usr/local/lib/python3.11/dist-packages (from sacrebleu) (0.9.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from sacrebleu) (2.0.2)\n","Collecting colorama (from sacrebleu)\n","  Downloading colorama-0.4.6-py2.py3-none-any.whl.metadata (17 kB)\n","Requirement already satisfied: lxml in /usr/local/lib/python3.11/dist-packages (from sacrebleu) (5.3.1)\n","Downloading sacrebleu-2.5.1-py3-none-any.whl (104 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m104.1/104.1 kB\u001b[0m \u001b[31m4.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\n","Downloading portalocker-3.1.1-py3-none-any.whl (19 kB)\n","Installing collected packages: portalocker, colorama, sacrebleu\n","Successfully installed colorama-0.4.6 portalocker-3.1.1 sacrebleu-2.5.1\n"]}]},{"cell_type":"code","source":["from sacrebleu.metrics import BLEU\n","\n","def get_score(pred, actutal):\n","\n","  hypotheses = pred.tolist()\n","\n","  references = actutal.tolist()\n","  references = [[ref] for ref in references]\n","\n","  bleu = BLEU()\n","  return bleu.corpus_score(hypotheses, references)"],"metadata":{"id":"tYyCjup6yrr-","executionInfo":{"status":"ok","timestamp":1742429142294,"user_tz":240,"elapsed":243,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":53,"outputs":[]},{"cell_type":"code","source":["get_score(df['text_translated'], df['Matched'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"O7x5RMKF3hSD","executionInfo":{"status":"ok","timestamp":1742429195087,"user_tz":240,"elapsed":48,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"d0833103-65f6-4503-c097-a81dff548dc7"},"execution_count":55,"outputs":[{"output_type":"execute_result","data":{"text/plain":["BLEU = 0.51 3.2/0.5/0.3/0.1 (BP = 1.000 ratio = 5.471 hyp_len = 93 ref_len = 17)"]},"metadata":{},"execution_count":55}]},{"cell_type":"code","source":["def cleaning_string(my_string):\n","    my_string = re.sub(r\"[^a-z0-9 ]+\", ' ', my_string.lower()) # lowercase then change special char to ''\n","    my_string = \" \".join(my_string.split()) # remove white space\n","\n","    return my_string\n","\n","def remove_duplicated_words(text):\n","    # Split text into words, handling punctuation\n","    words = re.findall(r'\\b\\w+\\b', text)\n","    seen = set()\n","    unique_words = []\n","    for word in words:\n","        if word.lower() not in seen:\n","            seen.add(word.lower())\n","            unique_words.append(word)\n","    return \" \".join(unique_words)"],"metadata":{"id":"T8ob6gYY36wo","executionInfo":{"status":"ok","timestamp":1742429262803,"user_tz":240,"elapsed":4,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":58,"outputs":[]},{"cell_type":"code","source":["df['Matched'] = df['Matched'].map(cleaning_string).map(remove_duplicated_words)\n","df['text_translated'] = df['text_translated'].map(cleaning_string).map(remove_duplicated_words)\n","df['Translated'] = df['Translated'].map(cleaning_string).map(remove_duplicated_words)"],"metadata":{"id":"yJWpW1pL4NMi","executionInfo":{"status":"ok","timestamp":1742429341626,"user_tz":240,"elapsed":40,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}}},"execution_count":63,"outputs":[]},{"cell_type":"code","source":["get_score(df['text_translated'], df['Translated'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FfZVNb5T4JNP","executionInfo":{"status":"ok","timestamp":1742429343938,"user_tz":240,"elapsed":6,"user":{"displayName":"TzuChun Lin","userId":"16886527610913465138"}},"outputId":"1c0904c2-9b78-4549-c364-f7b42566fa00"},"execution_count":64,"outputs":[{"output_type":"execute_result","data":{"text/plain":["BLEU = 21.36 100.0/20.0/12.5/8.3 (BP = 1.000 ratio = 1.000 hyp_len = 6 ref_len = 6)"]},"metadata":{},"execution_count":64}]},{"cell_type":"code","source":[],"metadata":{"id":"ygrlssuw4Xx2"},"execution_count":null,"outputs":[]}]}